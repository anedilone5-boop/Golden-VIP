<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Golden VIP ‚Äî Elite Dance Community</title>
<link rel="icon" type="image/png" href="https://i.ibb.co/9kLqvRK0/image-removebg-preview.png"/>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700;900&family=Montserrat:wght@300;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

<style>
  :root{
    --gold-primary: #D4AF37;
    --gold-light: #F8E9B0;
    --gold-dark: #AA8C2C;
    --bg-deep: #050505;
    --bg-card: #0f0f0f;
    --text-main: #e0e0e0;
    --text-muted: #888;
    --accent-red: #8a1c1c;
    --glass: rgba(20, 20, 20, 0.7);
    --border-gold: 1px solid rgba(212, 175, 55, 0.2);
    --font-heading: 'Cinzel', serif;
    --font-body: 'Montserrat', sans-serif;
 }

  /* RESET & BASE */
  *{box-sizing:border-box}
  html{scroll-behavior: smooth;}
  body{
    margin:0; font-family: var(--font-body);
    background-color: var(--bg-deep);
    background-image: 
        radial-gradient(circle at 10% 20%, rgba(212, 175, 55, 0.03) 0%, transparent 20%),
        radial-gradient(circle at 90% 80%, rgba(138, 28, 28, 0.03) 0%, transparent 20%);
    color: var(--text-main);
    overflow-x: hidden;
  }

  ::-webkit-scrollbar { width: 8px; }
  ::-webkit-scrollbar-track { background: var(--bg-deep); }
  ::-webkit-scrollbar-thumb { background: var(--gold-dark); border-radius: 4px; }

  /* TYPOGRAPHY */
  h1, h2, h3, h4 { font-family: var(--font-heading); text-transform: uppercase; margin: 0; }
  .section-title { text-align: center; margin-bottom: 50px; }
  .section-title h2 { font-size: 2.5rem; }
  
  span.gold-text {
    background: linear-gradient(to right, var(--gold-primary), var(--gold-light), var(--gold-primary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    font-weight: 900;
  }
  
  /* LAYOUT */
  .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
  section { padding: 80px 0; border-bottom: 1px solid rgba(255,255,255,0.03); }

  /* HEADER & NAV */
  header {
    position: fixed; top: 0; left: 0;
    width: 100%; z-index: 1000;
    background: rgba(5, 5, 5, 0.85); backdrop-filter: blur(12px);
    border-bottom: 1px solid rgba(212, 175, 55, 0.1);
    padding: 15px 0;
  }
  .nav-wrap { display: flex; justify-content: space-between; align-items: center; }
  .logo { display: flex; align-items: center; gap: 12px; text-decoration: none; }
  .logo img { height: 50px; border-radius: 50%; border: 2px solid var(--gold-primary); }
  .logo h1 { font-size: 22px; color: #fff; letter-spacing: 1px; }

  nav ul { display: flex; gap: 30px; list-style: none; margin: 0; padding: 0; }
  nav a { color: var(--text-main); text-decoration: none; font-size: 14px; font-weight: 500;
    letter-spacing: 1px; transition: 0.3s; text-transform: uppercase; }
  nav a:hover, nav a.active { color: var(--gold-primary); text-shadow: 0 0 10px rgba(212,175,55,0.4); }

  .mobile-toggle { display: none; background: none; border: none; color: var(--gold-primary); font-size: 28px; cursor: pointer; }

  /* HERO SECTION */
  .hero {
    min-height: 100vh;
    display: flex; align-items: center; justify-content: center;
    text-align: center;
    background: linear-gradient(to bottom, rgba(5,5,5,0.3), var(--bg-deep)), url('https://i.ibb.co/Gv05Nhtp/image-removebg-preview-1.png');
    background-size: cover; background-position: center; background-attachment: fixed;
    padding-top: 80px; position: relative;
 }
  .hero::after { content:''; position: absolute; inset:0; background: radial-gradient(circle, transparent 0%, var(--bg-deep) 100%); pointer-events: none; }
  
  .hero-content { position: relative; z-index: 2; max-width: 800px; animation: fadeInUp 1s ease-out; }
  .hero h2 { font-size: 3.5rem; line-height: 1.1; margin-bottom: 20px; text-shadow: 0 10px 30px rgba(0,0,0,0.8); }
  .hero p { font-size: 1.2rem; color: #ccc; margin-bottom: 40px; font-weight: 300; }

  .btn {
    display: inline-block; padding: 16px 40px; border-radius: 50px;
    font-family: var(--font-body); font-weight: 700; text-transform: uppercase;
    letter-spacing: 2px;
    text-decoration: none; transition: 0.4s; position: relative; overflow: hidden;
 }
  .btn-gold {
    background: linear-gradient(45deg, var(--gold-dark), var(--gold-primary));
    color: #000;
    box-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
  }
  .btn-gold:hover { transform: translateY(-3px); box-shadow: 0 0 40px rgba(212, 175, 55, 0.6); }
  .btn-outline { border: 1px solid var(--gold-primary); color: var(--gold-primary); margin-left: 15px; }
  .btn-outline:hover { background: rgba(212,175,55,0.1); color: #fff; border-color: #fff; }

  /* SECTIONS: VALUES & RULES */
  .grid-3 { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 40px; }
  
  .card-box {
    background: rgba(255,255,255,0.03); border: var(--border-gold);
    padding: 30px; border-radius: 4px;
    position: relative;
    transition: 0.4s; height: 100%;
  }
  .card-box:hover { background: rgba(212,175,55,0.08); transform: translateY(-5px); }
  .card-box h3 { color: var(--gold-primary); margin-bottom: 15px; font-size: 1.2rem; display: flex; align-items: center; gap: 10px; }
  .card-box p, .card-box li { color: #aaa; line-height: 1.6; font-size: 0.95rem; }
  
  .rules-list { list-style: none; padding: 0; margin: 0; text-align: left; }
  .rules-list li { margin-bottom: 12px; padding-left: 20px; position: relative; }
  .rules-list li::before { content: '‚ú¶'; color: var(--gold-primary); position: absolute; left: 0; }

  /* ACTIVITIES */
  .activities-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
  .activity-item { 
    background: var(--bg-card); padding: 25px; border-radius: 8px; 
    border-left: 3px solid var(--gold-primary);
 }
  .activity-item h4 { color: var(--gold-light); margin-bottom: 10px; font-size: 1.1rem; }
  .activity-item p { font-size: 0.9rem; color: #999; }

  /* BADGE GUIDE SECTION */
  .badge-guide-grid { 
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); 
      gap: 25px;
      margin-top: 30px;
  }
  .badge-guide-item {
      background: var(--bg-card); 
      padding: 20px;
      border-radius: 8px; 
      display: flex; 
      align-items: center; 
      gap: 15px;
      border: 1px solid #222;
      transition: 0.3s;
 }
  .badge-guide-item:hover {
      border-color: var(--gold-primary);
      transform: translateY(-2px);
      background: rgba(212, 175, 55, 0.05);
 }
  .badge-icon-wrap {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      flex-shrink: 0;
  }
  .badge-guide-text h4 {
      font-size: 1rem;
      color: var(--gold-light);
      margin-bottom: 5px;
  }
  .badge-guide-text p {
      font-size: 0.85rem;
      color: #999;
      margin: 0;
 }

  /* MEMBERS & LEADERS SHARED STYLES */
  .members-grid, .leader-wrap { 
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); 
    gap: 30px; 
    margin-top: 40px; 
    justify-content: center;
 }

  .member-card, .leader { 
    text-align: center; 
    position: relative; 
    padding-bottom: 40px;
    background: rgba(255,255,255,0.02);
    border-radius: 12px;
    padding: 20px;
    border: 1px solid transparent;
    transition: 0.3s;
  }
  .member-card:hover, .leader:hover {
      border-color: rgba(212, 175, 55, 0.3);
      background: rgba(255,255,255,0.04);
  }

  .leader img, .member-card img {
    width: 140px;
    height: 140px; 
    border-radius: 50%; 
    object-fit: cover;
    padding: 5px; 
    background: var(--bg-deep);
    transition: 0.4s;
 }
  
  .member-card img {
    width: 100px; 
    height: 100px; 
    border: 3px solid #333;
 }
  .leader img {
      border: 3px solid var(--gold-primary);
 }

  .leader:hover img, .member-card:hover img { box-shadow: 0 0 30px rgba(212,175,55,0.3); transform: scale(1.05); }
  
  .leader h4, .member-card h4 { 
    margin-top: 15px; 
    font-size: 1.1rem; 
    color: var(--gold-primary);
 }
  .member-card h4 { color: var(--text-main); font-size: 1rem; }
  
  .leader-role, .member-role { 
    font-size: 0.85rem;
    color: #777; 
    font-weight: 500;
    display: block;
    margin-bottom: 10px;
  }
  
  /* ESTILO PARA INSIGNIAS */
  .badge-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 5px;
      margin-top: 10px;
      width: 100%;
      min-height: 25px;
 }
  .multi-badge { 
    display: flex;
    align-items: center;
    justify-content: center;
    width: 24px; 
    height: 24px; 
    border-radius: 50%;
    font-size: 12px; 
    line-height: 1;
    color: #fff;
    box-shadow: 0 2px 5px rgba(0,0,0,0.5);
    border: 1px solid rgba(255,255,255,0.2);
    transition: transform 0.2s;
    cursor: help;
 }
  .multi-badge:hover {
      transform: scale(1.3);
      z-index: 10;
 }

  /* GALLERY, ADMIN UI, FOOTER */
  .gallery-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 30px;
    border-bottom: 1px solid #222; padding-bottom: 20px; }
  .stats { font-family: var(--font-heading); color: var(--gold-light); font-size: 0.9rem; }
  
  .masonry { column-count: 4; column-gap: 15px; }
  @media(max-width: 900px){ .masonry{column-count: 3;} }
  @media(max-width: 600px){ .masonry{column-count: 2;} }

  .media-item { break-inside: avoid; margin-bottom: 15px;
    position: relative; group: 1; border-radius: 8px; overflow: hidden; background: #000; }
  .media-item img, .media-item video { width: 100%;
    display: block; transition: 0.5s; opacity: 0.9; }
  .media-item:hover img, .media-item:hover video { opacity: 1; transform: scale(1.05); }
  
  .media-overlay {
    position: absolute; bottom: 0; left: 0; width: 100%;
    background: linear-gradient(to top, rgba(0,0,0,0.9), transparent);
    padding: 20px 10px 10px; transform: translateY(100%); transition: 0.3s;
    display: flex; justify-content: space-between; align-items: flex-end;
 }
  .media-item:hover .media-overlay { transform: translateY(0); }
  .media-title { font-size: 12px; color: #fff; font-weight: 600; }
  .btn-icon { background: rgba(255,255,255,0.1); border: 0; color: #fff; width: 28px; height: 28px; border-radius: 4px; cursor: pointer; display: flex;
    align-items: center; justify-content: center; }
  .btn-icon:hover { background: var(--gold-primary); color: #000; }

  .modal { display: none; position: fixed;
    inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; align-items: center; justify-content: center; backdrop-filter: blur(5px);
 }
  .modal-box { 
  background: #111; border: 1px solid var(--gold-dark); padding: 30px; width: 90%; max-width: 500px;
  text-align: center; border-radius: 12px;
  max-height: 90vh; /* Permite que el modal no sea m√°s alto que la pantalla */
  overflow-y: auto; /* Habilita el desplazamiento vertical si el contenido es muy largo */
}
  .modal-box input, .modal-box select { 
    width: 100%; padding: 12px;
    background: #000; border: 1px solid #333; color: #fff; margin: 15px 0; 
    border-radius: 6px; font-family: var(--font-body);
 }
  .modal-box input:focus, .modal-box select:focus { border-color: var(--gold-primary); outline: none; }
  .modal-box label { display: block; text-align: left;
    color: var(--gold-primary); margin-top: 15px; font-size: 0.9rem; }
  .member-list-item { 
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px; border-bottom: 1px solid #222;
    font-size: 0.9rem;
  }
  .member-list-item button { 
    background: var(--gold-primary);
    color: #000; border: none; padding: 5px 10px; border-radius: 4px; cursor: pointer;
    font-size: 12px; margin-left: 10px;
 }
  .current-badges-display {
      display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px;
      justify-content: center;
 }
  .current-badge {
      background: #222; padding: 4px 8px; border-radius: 4px; font-size: 12px;
 }

  footer { background: #020202; padding: 50px 0 20px; text-align: center; border-top: 1px solid #111; margin-top: 60px; }
  .socials { display: flex; justify-content: center; gap: 20px; margin-bottom: 30px; }
  .socials a { color: #555; font-size: 24px; transition: 0.3s; }
  .socials a:hover { color: var(--gold-primary); transform: translateY(-3px); }
  .copyright { color: #444; font-size: 12px; }
  #adminToggle { background: none; border: none; color: #111; font-size: 10px; cursor: pointer; margin-top: 20px; }
  #adminToggle:hover { color: #333; }

  .hidden { display: none !important; }
  .fade-in { opacity: 0; transform: translateY(20px); transition: 0.8s ease-out; }
  .fade-in.visible { opacity: 1; transform: translateY(0); }

  /* RESPONSIVE */
  @media(max-width: 768px){
    .hero h2 { font-size: 2.2rem; }
    .nav-wrap nav {
      display: none; position: absolute; top: 100%; left: 0; width: 100%;
      background: #000; flex-direction: column; padding: 20px; border-bottom: 1px solid #333;
 }
    .nav-wrap nav.open { display: flex; }
    .member-card img { width: 80px; height: 80px; }
    .badge-guide-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<header>
  <div class="container nav-wrap">
    <a href="#" class="logo">
      <img id="siteLogo" src="https://i.ibb.co/9kLqvRK0/image-removebg-preview.png" alt="Golden VIP">
      <h1><span class="gold-text">GOLDEN</span> VIP</h1>
    </a>
    <button class="mobile-toggle" id="mobileMenuBtn">‚ò∞</button>
    <nav id="mainNav">
      <ul>
        <li><a href="#home">Inicio</a></li>
        <li><a href="#about">Filosof√≠a</a></li>
        <li><a href="#badge-guide">Insignias</a></li>
        <li><a href="#members">Miembros</a></li>
        <li><a href="#gallery">Galer√≠a</a></li>
        <li><a href="#team">L√≠deres</a></li>
      </ul>
    </nav>
  </div>
</header>

<section id="home" class="hero">
  <div class="hero-content">
    <h2>EL ESCENARIO ES <br><span class="gold-text">NUESTRO LEGADO</span></h2>
    <p>La comunidad de baile m√°s exclusiva de Avakin Life & IMVU. Donde la elegancia se encuentra con el talento.</p>
    <div>
      <a href="https://www.instagram.com/goldenvipoficial/" target="_blank" class="btn btn-gold">√önete al Casting</a>
      <a href="#about" class="btn btn-outline">Leer M√°s</a>
    </div>
  </div>
</section>

<section id="about">
  <div class="container">
    <div class="section-title fade-in">
      <h3 style="color: var(--gold-primary); letter-spacing: 3px;">Manifiesto</h3>
      <h2>Disciplina & Estilo</h2>
    </div>

    <div class="grid-3">
      <div class="card-box fade-in">
        <h3><i class="fas fa-handshake"></i> Reglamento (Accesible)</h3>
        <ul class="rules-list">
          <li>**Compromiso M√≠nimo:** Participa activamente en al menos un evento o ensayo semanal para mantener el ritmo y la visibilidad.</li>
          <li>**C√≥digo de Vestimenta:** Coordinaci√≥n de outfits y est√©tica de √©lite en eventos y grabaciones. La imagen es primordial.</li>
          <li>**Respeto y Profesionalismo:** Trata a todos los miembros y la junta directiva con respeto. Fomentamos un ambiente familiar, no de conflicto.</li>
          <li>**Comunicaci√≥n Clave:** Informa a un l√≠der sobre cualquier ausencia prolongada o inconveniente. La transparencia es vital para el grupo.</li>
          <li>**Disciplina en Eventos:** La ejecuci√≥n de coreograf√≠as debe ser impecable. Sigue las instrucciones del core√≥grafo durante las presentaciones.</li>
        </ul>
      </div>

      <div class="card-box fade-in">
        <h3><i class="fas fa-chart-line"></i> Visi√≥n</h3>
        <p>No somos solo avatares; somos artistas digitales. Buscamos la perfecci√≥n en cada coreograf√≠a y la excelencia en el rendimiento de cada miembro. Nuestra meta es establecer un est√°ndar de √©lite inigualable, fusionando t√©cnica y arte digital. Nos enfocamos en el crecimiento individual y colectivo para mantener a <span class="gold-text">Golden VIP</span> como un legado duradero y respetado en el metaverso.</p>
      </div>

      <div class="card-box fade-in">
        <h3><i class="fas fa-medal"></i> Camino a la Distinci√≥n VIP</h3>
        <p style="margin-bottom: 20px;">Cada una de nuestras actividades y el comportamiento diario son caminos para obtener nuestras 23 insignias de √©lite:</p>
        <div class="activities-grid" style="margin-top: 15px; grid-template-columns: 1fr;">
            <div class="activity-item">
                <h4><i class="fas fa-check-circle"></i> Disciplina y Asistencia</h4>
                <p>La puntualidad y constancia en ensayos son clave para obtener insignias como **Discipline**, **Focus Shield** y **Attendance**.</p>
            </div>
            <div class="activity-item">
                <h4><i class="fas fa-running"></i> Rendimiento en Eventos</h4>
                <p>Destacar en presentaciones y torneos internos (Battles) puede llevarte al **Step Master** o la medalla de **Impact**.</p>
            </div>
            <div class="activity-item">
                <h4><i class="fas fa-users"></i> Liderazgo y Compa√±erismo</h4>
                <p>Apoyar a otros y mantener la unidad es la v√≠a para ganar las insignias **Golden Heart** o **Leader**.</p>
            </div>
            <div class="activity-item">
                <h4><i class="fas fa-paint-brush"></i> Creatividad y Estilo</h4>
                <p>Aportar ideas innovadoras en coreograf√≠as o vestuario te recompensa con **Creativity Flame** o **Style Crown**.</p>
            </div>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="badge-guide" style="background: rgba(255,255,255,0.02);">
  <div class="container">
    <h3 style="text-align:center; color: var(--gold-primary); margin-bottom: 10px;">Reconocimiento y Estatus</h3>
    <h2 style="text-align:center; margin-bottom: 50px;">Gu√≠a de Condecoraciones VIP (23)</h2>
    <div class="badge-guide-grid" id="badgeGuideGrid"></div>
  </div>
</section>

<section id="members">
  <div class="container">
    <h3 style="text-align:center; color: var(--gold-primary); margin-bottom: 10px;">La Comunidad</h3>
    <h2 style="text-align:center; margin-bottom: 50px;">Nuestros Talentos VIP</h2>
    <div class="members-grid" id="membersGrid"></div>
  </div>
</section>

<section id="team">
  <div class="container">
    <h2 style="text-align:center; margin-bottom: 40px;">Junta Directiva</h2>
    <div class="leader-wrap fade-in" id="leaderWrap"></div>
  </div>
</section>

<section id="gallery">
  <div class="container">
    <div class="gallery-header fade-in">
      <div>
        <h3 style="color:var(--gold-primary)">Portfolio Visual</h3>
        <p style="margin:0; color:#666;">Momentos inmortales de nuestra trayectoria.</p>
      </div>
      <div class="stats" id="galleryStats">0 Capturas ¬∑ 0 Clips</div>
    </div>
    
    <div id="adminControls" class="hidden" style="margin-bottom: 20px; background: #222; padding: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center;">
        <span style="color:var(--gold-primary); font-weight:bold;"> Modo Administrador</span>
        <div style="display:flex; gap:10px;">
            <button id="manageLogoBtn" class="btn-icon" style="width: auto; padding: 0 15px; background: #0088AA; color: #fff;">Gestionar Logo</button>
            <button id="manageProfilesBtn" class="btn-icon" style="width: auto; padding: 0 15px; background: #5a5a5a; color: #fff;">Gestionar Miembros/L√≠deres</button>
            <button id="manageBadgesBtn" class="btn-icon" style="width: auto; padding: 0 15px; background: var(--accent-red); color: #fff;">Gestionar Insignias</button>
            <button id="uploadTriggerBtn" class="btn-icon" style="width: auto; padding: 0 15px; background: var(--gold-primary); color: #000;">+ Subir Contenido</button>
        </div>
        <input type="file" id="fileInput" accept="image/*,video/*" style="display:none" />
    </div>

    <div class="masonry" id="galleryGrid"></div>

  </div>
</section>


<footer>
  <div class="container">
    <div class="socials">
      <a href="https://www.instagram.com/goldenvipoficial/" target="_blank" title="Instagram Oficial"><i class="fab fa-instagram"></i></a>
      <a href="#" style="cursor: default; opacity: 0.6;" title="TikTok (No funcional)"><i class="fab fa-tiktok"></i></a>
      <a href="#" style="cursor: default; opacity: 0.6;" title="YouTube (No funcional)"><i class="fab fa-youtube"></i></a>
    </div>
    <p class="copyright">¬© 2025 GOLDEN VIP. Todos los derechos reservados.</p>
    <button id="adminToggle">Staff Login</button>
  </div>
</footer>

<div id="loginModal" class="modal">
  <div class="modal-box">
    <h3 style="color:var(--gold-primary)">Acceso Restringido</h3>
    <p style="font-size:13px; color:#888;">Introduce la llave maestra para gestionar contenido.</p>
    <input type="password" id="adminPassInput" placeholder="Contrase√±a...">
    <div style="display:flex; gap:10px; justify-content:center;">
      <button id="doLoginBtn" class="btn-gold" style="border:0; cursor:pointer; padding:10px 20px; font-size:14px;">Entrar</button>
      <button id="closeLoginBtn" style="background:transparent; border:1px solid #444; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer;">Cancelar</button>
    </div>
  </div>
</div>

<div id="uploadModal" class="modal">
  <div class="modal-box">
    <h3 style="color:var(--gold-primary)">Publicar Contenido</h3>
    <input type="text" id="mediaTitleInput" placeholder="T√≠tulo o descripci√≥n corta...">
    <div style="display:flex; gap:10px; justify-content:center;">
      <button id="confirmUploadBtn" class="btn-gold" style="border:0; cursor:pointer; padding:10px 20px; font-size:14px;">Publicar</button>
      <button id="cancelUploadBtn" style="background:transparent; border:1px solid #444; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer;">Cancelar</button>
    </div>
  </div>
</div>

<div id="badgesModal" class="modal">
    <div class="modal-box" style="max-width: 600px;">
        <h3 style="color:var(--gold-primary)">Gestionar Insignias de Miembros</h3>
        <p style="font-size:13px; color:#888;">Agrega o retira condecoraciones a cualquier miembro.</p>
        
        <label for="memberUsernameInput">Nombre del Miembro:</label>
        <input type="text" id="memberUsernameInput" placeholder="Nombre de Avakin/IMVU">
        
        <label for="memberBadgeSelect">Insignia:</label>
        <select id="memberBadgeSelect">
            <option value="">(Seleccionar Insignia)</option>
        </select>
        
        <div class="current-badges-display" id="currentMemberBadges"></div>

        <div style="display:flex; gap:10px; justify-content:center; margin-top: 20px;">
            <button id="addBadgeBtn" class="btn-gold" style="border:0; cursor:pointer; padding:10px 20px; font-size:14px;">Agregar Insignia</button>
            <button id="removeBadgeBtn" style="background:var(--accent-red); border:0; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer; font-size:14px;">Eliminar Insignia</button>
        </div>
        
        <button id="closeBadgesBtn" style="background:transparent; border:1px solid #444; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer; margin-top: 20px;">Cerrar</button>

        <h4 style="margin-top: 30px; color:var(--gold-light); font-size: 1.2rem; border-top: 1px solid #222; padding-top: 20px;">Miembros con Insignias:</h4>
        <div id="rankedMemberList" style="max-height: 200px; overflow-y: auto; text-align: left;"></div>
    </div>
</div>

<div id="logoModal" class="modal">
    <div class="modal-box" style="max-width: 400px;">
        <h3 style="color:var(--gold-primary)">Actualizar Logo del Sitio</h3>
        <p style="font-size:13px; color:#888;">Cambia el logo principal del encabezado. (URL de imagen).</p>
        <label for="newLogoUrlInput">Nueva URL de la Imagen (Link Directo):</label>
        <input type="url" id="newLogoUrlInput" placeholder="https://i.ibb.co/nuevo-logo.png">
        <div style="display:flex; gap:10px; justify-content:center; margin-top: 20px;">
            <button id="updateLogoBtn" class="btn-gold" style="border:0; cursor:pointer; padding:10px 20px; font-size:14px;">Actualizar Logo</button>
        </div>
        <button id="closeLogoBtn" style="background:transparent; border:1px solid #444; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer; margin-top: 20px;">Cerrar</button>
    </div>
</div>

<div id="profileModal" class="modal">
    <div class="modal-box" style="max-width: 600px;">
        <h3 style="color:var(--gold-primary)">Administrar Perfiles (Miembros y L√≠deres)</h3>
        <p style="font-size:13px; color:#888;">Edita, elimina o crea perfiles de la Junta Directiva y Miembros VIP.</p>
        
        <h4 style="margin-top: 20px; color:var(--gold-light); font-size: 1.1rem; border-top: 1px solid #333; padding-top: 15px;">Editar Perfil Existente:</h4>
        <label for="profileMemberSelect">Seleccionar Miembro/L√≠der:</label>
        <select id="profileMemberSelect" style="margin-bottom: 15px;">
            <option value="">(Seleccionar Perfil para Editar)</option>
        </select>
        
        <div id="profileEditForm" class="hidden" style="text-align: left; padding-top: 5px;">
            <label for="editNameInput">Nuevo Nombre:</label>
            <input type="text" id="editNameInput" placeholder="Nombre de Avakin/IMVU">

            <label for="editRoleInput">Nuevo Rol (Ej: CEO, Director, Bailar√≠n VIP):</label>
            <input type="text" id="editRoleInput" placeholder="Rol del Miembro/L√≠der">

            <label for="editImageUrlInput">URL de la Imagen (Link Directo):</label>
            <input type="url" id="editImageUrlInput" placeholder="https://i.ibb.co/nueva-imagen.jpg">

            <div style="display:flex; gap:10px; justify-content:center; margin-top: 20px;">
                <button id="updateProfileBtn" class="btn-gold" style="border:0; cursor:pointer; padding:10px 20px; font-size:14px;">Guardar Cambios</button>
                <button id="deleteMemberBtn" style="background:var(--accent-red); border:0; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer; font-size:14px;">Eliminar Perfil</button>
            </div>
        </div>

        <h4 style="margin-top: 30px; color:var(--gold-light); font-size: 1.1rem; border-top: 1px solid #333; padding-top: 15px;">Crear Nuevo Perfil:</h4>
        <div id="newProfileForm" style="text-align: left;">
            <label for="newNameInput">Nombre (√önico):</label>
            <input type="text" id="newNameInput" placeholder="Nombre de Avakin/IMVU">

            <label for="newRoleInput">Rol (Ej: CEO, Director, Bailar√≠n VIP):</label>
            <input type="text" id="newRoleInput" placeholder="Rol del Miembro/L√≠der">

            <label for="newImageUrlInput">URL de la Imagen (Opcional):</label>
            <input type="url" id="newImageUrlInput" placeholder="https://i.ibb.co/nueva-imagen.jpg">
            
            <div style="display:flex; justify-content:center; margin-top: 20px;">
                <button id="createMemberBtn" class="btn-gold" style="border:0; cursor:pointer; padding:10px 20px; font-size:14px;">Crear Perfil</button>
            </div>
        </div>
        
        <button id="closeProfileBtn" style="background:transparent; border:1px solid #444; color:#fff; padding:10px 20px; border-radius:50px; cursor:pointer; margin-top: 20px;">Cerrar</button>
    </div>
</div>
  
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  
<script>
document.addEventListener("DOMContentLoaded", async function(){
  // --- CONFIGURACI√ìN DE SUPABASE Y CLOUDINARY ---
  // TUS CREDENCIALES DE SUPABASE (INSERTADAS AQU√ç)
  const SUPABASE_URL = 'https://vohdvamastvhqlfyjnln.supabase.co';
  const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvaGR2YW1hc3R2aHFsZnlqbmxuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1MDEzNDUsImV4cCI6MjA4MDA3NzM0NX0.Xwzlyjhf7MofwZancNRyu3X0luYl9P5unB0s7UMBNlg';

  const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

  const CONFIG = {
    cloudName: "dkwlzwvfg", 
    uploadPreset: "goldenvip_uploads", 
    adminPass: "Aneury00523"
  };
  
  const GENERIC_MEMBER_IMAGE = "https://i.ibb.co/rQG572B/default-avatar.png";

  // --- DATOS DE INSIGNIAS ---
  const BADGE_DATA = {
    'Heart': { name: 'Golden Heart', icon: '‚ù§Ô∏è', color: '#FF6B6B', desc: 'Reconoce el compa√±erismo.' },
    'Discipline': { name: 'VIP Discipline', icon: 'üõ°Ô∏è', color: '#3A4164', desc: 'Puntualidad y compromiso.' },
    'StepMaster': { name: 'Golden Step Master', icon: 'üë£', color: '#00BF63', desc: 'Dominio de coreograf√≠a.' },
    'EnergySpark': { name: 'VIP Energy Spark', icon: 'üî•', color: '#FF5733', desc: 'Energ√≠a explosiva.' },
    'Leader': { name: 'Golden Leader', icon: '‚≠ê', color: '#FFD700', desc: 'Liderazgo positivo.' },
    'Creativity': { name: 'VIP Creativity Flame', icon: 'üí°', color: '#8A2BE2', desc: 'Ideas brillantes.' },
    'SyncAward': { name: 'Golden Sync Award', icon: 'üîó', color: '#33B5E5', desc: 'Sincronizaci√≥n impecable.' },
    'GrowthMedal': { name: 'VIP Growth Medal', icon: 'üå±', color: '#99CC00', desc: 'Mayor crecimiento.' },
    'StageAura': { name: 'Golden Stage Aura', icon: '‚ú®', color: '#FF8800', desc: 'Presencia esc√©nica.' },
    'RhythmPulse': { name: 'VIP Rhythm Pulse', icon: 'ü•Å', color: '#E533FF', desc: 'Sentido del ritmo.' },
    'FocusShield': { name: 'Golden Focus Shield', icon: 'üéØ', color: '#0099CC', desc: 'Concentraci√≥n total.' },
    'RespectSeal': { name: 'VIP Respect Seal', icon: 'ü§ù', color: '#6699FF', desc: 'Respeto al equipo.' },
    'ImpactMedal': { name: 'Golden Impact Medal', icon: 'üí•', color: '#FF3333', desc: 'Impacto memorable.' },
    'Resilience': { name: 'VIP Resilience Badge', icon: 'üí™', color: '#FF6600', desc: 'Fortaleza y superaci√≥n.' },
    'Harmony': { name: 'Golden Harmony Award', icon: 'üïäÔ∏è', color: '#CCCCCC', desc: 'Mantiene la armon√≠a.' },
    'StyleCrown': { name: 'VIP Style Crown', icon: 'üëë', color: '#FFB900', desc: 'Estilo √∫nico.' },
    'Technique': { name: 'Golden Technique Star', icon: '‚öôÔ∏è', color: '#00CED1', desc: 'T√©cnica limpia.' },
    'Attendance': { name: 'VIP Attendance Honor', icon: '‚úÖ', color: '#4CAF50', desc: 'Asistencia perfecta.' },
    'Vision': { name: 'Golden Vision Badge', icon: 'üî≠', color: '#A020F0', desc: 'Visi√≥n de futuro.' },
    'TeamSoul': { name: 'VIP Team Soul', icon: 'üî•', color: '#FF4500', desc: 'Alma del grupo.' },
    'Founder': { name: 'Founder Emblem', icon: '‚öúÔ∏è', color: '#D4AF37', desc: 'Distinci√≥n m√°xima al fundador.' },
    'CEO': { name: 'Director CEO Seal', icon: 'üîë', color: '#AA8C2C', desc: 'Liderazgo estrat√©gico.' },
    'Honor': { name: 'Golden Star Honor', icon: 'üåü', color: '#FFD700', desc: 'Excelencia extraordinaria.' }
  };

  let state = {
    items: [],
    memberBadges: [],
    logoUrl: "https://i.ibb.co/9kLqvRK0/image-removebg-preview.png",
    isAdmin: false,
    pendingFile: null
  };
  
  // --- ELEMENTOS DOM (ACTUALIZADO) ---
  const els = {
    grid: document.getElementById('galleryGrid'),
    stats: document.getElementById('galleryStats'),
    adminControls: document.getElementById('adminControls'),
    fileInput: document.getElementById('fileInput'),
    leaderWrap: document.getElementById('leaderWrap'),
    membersGrid: document.getElementById('membersGrid'),
    loginModal: document.getElementById('loginModal'),
    uploadModal: document.getElementById('uploadModal'),
    badgesModal: document.getElementById('badgesModal'),
    profileModal: document.getElementById('profileModal'), // NEW
    logoModal: document.getElementById('logoModal'),
    siteLogo: document.getElementById('siteLogo'),
    manageLogoBtn: document.getElementById('manageLogoBtn'),
    manageProfilesBtn: document.getElementById('manageProfilesBtn'), // RENAMED
    adminPassInput: document.getElementById('adminPassInput'),
    mediaTitleInput: document.getElementById('mediaTitleInput'),
    manageBadgesBtn: document.getElementById('manageBadgesBtn'),
    memberUsernameInput: document.getElementById('memberUsernameInput'), 
    memberBadgeSelect: document.getElementById('memberBadgeSelect'),
    addBadgeBtn: document.getElementById('addBadgeBtn'), 
    removeBadgeBtn: document.getElementById('removeBadgeBtn'),
    rankedMemberList: document.getElementById('rankedMemberList'),
    currentMemberBadges: document.getElementById('currentMemberBadges'),
    badgeGuideGrid: document.getElementById('badgeGuideGrid'),
    // Profile Modal Elements (NEW/RENAMED)
    profileMemberSelect: document.getElementById('profileMemberSelect'),
    profileEditForm: document.getElementById('profileEditForm'),
    editNameInput: document.getElementById('editNameInput'),
    editRoleInput: document.getElementById('editRoleInput'),
    editImageUrlInput: document.getElementById('editImageUrlInput'),
    updateProfileBtn: document.getElementById('updateProfileBtn'),
    deleteMemberBtn: document.getElementById('deleteMemberBtn'),
    closeProfileBtn: document.getElementById('closeProfileBtn'),
    // New Member Creation Elements (NEW)
    newNameInput: document.getElementById('newNameInput'),
    newRoleInput: document.getElementById('newRoleInput'),
    newImageUrlInput: document.getElementById('newImageUrlInput'),
    createMemberBtn: document.getElementById('createMemberBtn'),
    //
    newLogoUrlInput: document.getElementById('newLogoUrlInput'),
    mobileMenuBtn: document.getElementById('mobileMenuBtn'),
    mainNav: document.querySelector('#mainNav')
  };

  // --- LOGICA PRINCIPAL ---
  
  async function loadData(){
    console.log("üîÑ Sincronizando datos...");
    try {
      // 1. Logo
      const { data: configData } = await supabaseClient.from('config').select('*').eq('key', 'site_logo').single();
      if(configData) {
        state.logoUrl = configData.value;
        els.siteLogo.src = state.logoUrl;
      }

      // 2. Miembros
      const { data: membersData } = await supabaseClient.from('members').select('*');
      if(membersData) state.memberBadges = membersData;
      
      // 3. Galer√≠a
      const { data: galleryData } = await supabaseClient.from('gallery').select('*').order('created_at', { ascending: true });
      if(galleryData) state.items = galleryData;
      
      // Render
      renderGallery();
      renderTeam();
      renderMembers();
      renderBadgeGuide();
      
    } catch(err) {
      console.error("‚ùå Error en loadData:", err);
    }
  }

  // Helper para saber si es L√≠der
  function isLeader(m) {
      const b = m.badges || [];
      const r = (m.role || '').toLowerCase();
      // Si tiene insignia de poder o rol de director/lider
      return b.includes('CEO') || b.includes('Founder') || b.includes('Leader') || r.includes('director') || r.includes('lider');
  }

  function createBadgeHtml(badgesArray) {
    if (!badgesArray || !Array.isArray(badgesArray) || badgesArray.length === 0) {
        return '<div class="badge-list" style="min-height: 24px;"></div>'; 
    }
    const badgesHtml = badgesArray.map(badgeKey => {
      const data = BADGE_DATA[badgeKey] || { name: '?', icon: '?', color: '#555' };
      return `<div class="multi-badge" style="background:${data.color};" title="${data.name}">${data.icon}</div>`;
    }).join('');
    return `<div class="badge-list">${badgesHtml}</div>`;
  }

  function renderBadgeGuide() {
    els.badgeGuideGrid.innerHTML = '';
    Object.keys(BADGE_DATA).forEach(key => {
      const data = BADGE_DATA[key];
      const item = document.createElement('div');
      item.className = 'badge-guide-item';
      item.innerHTML = `
        <div class="badge-icon-wrap" style="background-color: ${data.color}; color: ${data.color === '#CCCCCC' ? '#000' : '#fff'};">${data.icon}</div>
        <div class="badge-guide-text"><h4>${data.name}</h4><p>${data.desc}</p></div>`;
      els.badgeGuideGrid.appendChild(item);
    });
  }

  function renderTeam() {
    els.leaderWrap.innerHTML = '';
    const leaders = state.memberBadges.filter(isLeader);
    
    leaders.forEach(leader => {
      const div = document.createElement('div');
      div.className = 'leader'; // Sin fade-in din√°mico
      div.innerHTML = `
        <img src="${leader.image || GENERIC_MEMBER_IMAGE}" alt="${leader.name}">
        <h4>${leader.name}</h4>
        <span class="leader-role">${leader.role || 'L√≠der VIP'}</span>
        ${createBadgeHtml(leader.badges)}
      `;
      els.leaderWrap.appendChild(div);
    });
  }

  function renderMembers() {
    els.membersGrid.innerHTML = '';
    const members = state.memberBadges.filter(m => !isLeader(m));
    
    if (members.length === 0) {
      els.membersGrid.innerHTML = `<p style="grid-column:1/-1; text-align:center; color:#444;">No hay miembros listados a√∫n.</p>`;
      return;
    }

    members.forEach(member => {
      const div = document.createElement('div');
      div.className = 'member-card'; // Sin fade-in din√°mico
      div.innerHTML = `
        <img src="${member.image || GENERIC_MEMBER_IMAGE}" alt="${member.name}">
        <h4>${member.name}</h4>
        <span class="member-role">${member.role || 'Miembro Oficial'}</span>
        ${createBadgeHtml(member.badges)}
      `;
      els.membersGrid.appendChild(div);
    });
  }
  
  function renderGallery(){
    els.grid.innerHTML = "";
    if(state.items.length === 0){
      els.grid.innerHTML = `<p style="grid-column:1/-1; text-align:center; color:#444;">La galer√≠a est√° vac√≠a.</p>`;
      return;
    }
    [...state.items].reverse().forEach(item => {
      const div = document.createElement('div');
      div.className = 'media-item';
      let contentHtml = item.type === 'video' 
        ? `<video src="${item.url}" controls autoplay style="max-width:100%;max-height:90vh;border-radius:8px;"></video>` 
        : `<img src="${item.url}" alt="${item.title}" loading="lazy">`;
      let adminHtml = state.isAdmin ? 
        `<button class="btn-icon" onclick="deleteItem(${item.id})" title="Borrar">üóëÔ∏è</button>` : '';
      div.innerHTML = `
        ${contentHtml}
        <div class="media-overlay">
          <span class="media-title">${item.title || 'Sin t√≠tulo'}</span>
          <div style="display:flex; gap:5px;">
            <button class="btn-icon" onclick="viewItem('${item.url}', '${item.type}')">üëÅÔ∏è</button>
            ${adminHtml}
          </div>
        </div>`;
      els.grid.appendChild(div);
    });
    updateStats();
  }

  function renderRankedMemberList() {
    els.rankedMemberList.innerHTML = '';
    state.memberBadges.sort((a, b) => a.name.localeCompare(b.name)).forEach(member => {
      const div = document.createElement('div');
      div.className = 'member-list-item';
      const badgeCount = member.badges ? member.badges.length : 0;
      div.innerHTML = `<span>**${member.name}** (${badgeCount} insignias)</span>
                       <button onclick="editMemberBadges('${member.name}')">Administrar</button>`;
      els.rankedMemberList.appendChild(div);
    });
  }

  function displayCurrentBadges(name) {
    const member = state.memberBadges.find(m => m.name.toLowerCase() === name.toLowerCase());
    els.currentMemberBadges.innerHTML = '';
    if (!member || !member.badges || member.badges.length === 0) {
      els.currentMemberBadges.innerHTML = '<p style="color:#888;">Sin insignias.</p>';
      return;
    }
    member.badges.forEach(badgeKey => {
      const data = BADGE_DATA[badgeKey] || { name: '?', icon: '?', color: '#555' };
      const span = document.createElement('span');
      span.className = 'current-badge';
      span.innerHTML = `${data.icon} ${data.name}`;
      els.currentMemberBadges.appendChild(span);
    });
  }
  
  // Funci√≥n para rellenar el selector de perfiles en el modal de gesti√≥n de perfiles
  function populateProfileSelect() {
    els.profileMemberSelect.innerHTML = '<option value="">(Seleccionar Perfil para Editar)</option>';
    state.memberBadges.sort((a, b) => a.name.localeCompare(b.name)).forEach(member => {
        const option = document.createElement('option');
        option.value = member.id; 
        option.textContent = `${member.name} (${member.role || 'Sin Rol'})`;
        els.profileMemberSelect.appendChild(option);
    });
  }

  // --- ADMIN ACTIONS ---
  
  // 1. Logo
  document.getElementById('updateLogoBtn').addEventListener('click', async () => {
    const newUrl = els.newLogoUrlInput.value.trim();
    if (!newUrl) return alert('URL inv√°lida');
    const { error } = await supabaseClient.from('config').upsert({ key: 'site_logo', value: newUrl });
    if(!error){
      alert('Logo actualizado ‚úÖ');
      els.logoModal.style.display = 'none';
      await loadData(); // Recarga
    }
  });

  // 2. Gestionar Perfiles (Nuevo)
  els.manageProfilesBtn.onclick = () => { 
    populateProfileSelect();
    els.profileModal.style.display = 'flex'; 
    els.profileEditForm.classList.add('hidden'); // Ocultar formulario al abrir
    // Clear New Profile form
    els.newNameInput.value = '';
    els.newRoleInput.value = '';
    els.newImageUrlInput.value = '';
  };
  els.closeProfileBtn.onclick = () => els.profileModal.style.display = 'none';

  els.profileMemberSelect.onchange = () => {
    const memberId = els.profileMemberSelect.value;
    if (!memberId) {
        els.profileEditForm.classList.add('hidden');
        return;
    }
    const member = state.memberBadges.find(m => m.id.toString() === memberId);
    if (member) {
        els.editNameInput.value = member.name;
        els.editRoleInput.value = member.role || '';
        els.editImageUrlInput.value = member.image || GENERIC_MEMBER_IMAGE;
        els.profileEditForm.classList.remove('hidden');
    }
  };

  els.updateProfileBtn.addEventListener('click', async () => {
    const memberId = els.profileMemberSelect.value;
    const newName = els.editNameInput.value.trim();
    const newRole = els.editRoleInput.value.trim();
    const newImage = els.editImageUrlInput.value.trim();

    if (!memberId || !newName) return alert('Nombre es obligatorio.');

    const { error } = await supabaseClient.from('members').update({ 
        name: newName, 
        role: newRole, 
        image: newImage 
    }).eq('id', memberId);

    if(!error) {
        alert('Perfil actualizado ‚úÖ');
        await loadData(); // Recarga
        populateProfileSelect(); // Actualiza la lista
        els.profileMemberSelect.value = memberId; // Mantiene seleccionado el miembro editado
    } else {
        alert('Error al actualizar: ' + error.message);
    }
  });

  els.deleteMemberBtn.addEventListener('click', async () => {
    const memberId = els.profileMemberSelect.value;
    const memberName = els.editNameInput.value;
    
    if (!memberId) return;

    if(confirm(`¬øEst√°s seguro de ELIMINAR permanentemente a ${memberName} y todos sus datos? Esta acci√≥n no se puede deshacer.`)) {
        const { error } = await supabaseClient.from('members').delete().eq('id', memberId);
        
        if(!error) {
            alert(`Miembro ${memberName} eliminado üóëÔ∏è`);
            await loadData(); // Recarga
            els.profileModal.style.display = 'none';
        } else {
            alert('Error al eliminar: ' + error.message);
        }
    }
  });
  
  // New Member Creation Logic
  els.createMemberBtn.addEventListener('click', async () => {
      const newName = els.newNameInput.value.trim();
      const newRole = els.newRoleInput.value.trim() || 'Miembro Oficial';
      const newImage = els.newImageUrlInput.value.trim() || GENERIC_MEMBER_IMAGE;
      
      if (!newName) return alert('El nombre es obligatorio para crear un perfil.');

      // Check for existing member with the same name (case-insensitive for a simple check)
      const existingMember = state.memberBadges.find(m => m.name.toLowerCase() === newName.toLowerCase());
      if (existingMember) return alert(`Ya existe un miembro con el nombre "${newName}".`);
      
      const { error } = await supabaseClient.from('members').insert([{ 
          name: newName, 
          role: newRole, 
          image: newImage,
          badges: []
      }]);

      if(!error) {
          alert(`Perfil de ${newName} creado exitosamente ‚úÖ`);
          
          // Clear inputs
          els.newNameInput.value = '';
          els.newRoleInput.value = '';
          els.newImageUrlInput.value = '';

          await loadData(); // Recarga
          populateProfileSelect(); // Actualiza la lista para edici√≥n
      } else {
          alert('Error al crear perfil: ' + error.message);
      }
  });


  // 3. Agregar Insignia
  els.addBadgeBtn.addEventListener('click', async () => {
    const name = els.memberUsernameInput.value.trim();
    const badgeKey = els.memberBadgeSelect.value;
    if (!name || !badgeKey) return alert('Faltan datos');

    let member = state.memberBadges.find(m => m.name.toLowerCase() === name.toLowerCase());

    if (!member) {
      // Crear nuevo
      const { error } = await supabaseClient.from('members').insert([{ name: name, image: GENERIC_MEMBER_IMAGE, badges: [badgeKey], role: 'Talento Asignado' }]);
      if(!error) alert('Miembro creado e insignia asignada ‚úÖ');
    } else {
      // Actualizar
      let currentBadges = member.badges || [];
      if(!currentBadges.includes(badgeKey)){
        const newBadges = [...currentBadges, badgeKey];
        const { error } = await supabaseClient.from('members').update({ badges: newBadges }).eq('id', member.id);
        if(!error) alert('Insignia agregada ‚úÖ');
      } else {
        alert('Este miembro ya tiene esa insignia');
      }
    }
    // RECARGA COMPLETA PARA QUE SALGA EN LA COMUNIDAD
    await loadData(); 
    displayCurrentBadges(name); 
    renderRankedMemberList();
  });

  // 4. Remover Insignia
  els.removeBadgeBtn.addEventListener('click', async () => {
    const name = els.memberUsernameInput.value.trim();
    const badgeKey = els.memberBadgeSelect.value;
    let member = state.memberBadges.find(m => m.name.toLowerCase() === name.toLowerCase());
    
    if(member && member.badges && member.badges.includes(badgeKey)){
      const newBadges = member.badges.filter(b => b !== badgeKey);
      const { error } = await supabaseClient.from('members').update({ badges: newBadges }).eq('id', member.id);
      if(!error){
        alert('Insignia retirada üóëÔ∏è');
        await loadData(); // Recarga
        displayCurrentBadges(name); 
        renderRankedMemberList();
      }
    }
  });

  // 5. Galer√≠a - Borrar
  window.deleteItem = async function(id){
    if(!confirm("¬øBorrar de la base de datos?")) return;
    const { error } = await supabaseClient.from('gallery').delete().eq('id', id);
    if(!error) await loadData();
  };

  // 6. Galer√≠a - Subir
  document.getElementById('confirmUploadBtn').addEventListener('click', async () => {
    if(!state.pendingFile) return;
    const btn = document.getElementById('confirmUploadBtn');
    btn.textContent = "Subiendo..."; btn.disabled = true;

    try {
      const fd = new FormData();
      fd.append("file", state.pendingFile);
      fd.append("upload_preset", CONFIG.uploadPreset);
      const res = await fetch(`https://api.cloudinary.com/v1_1/${CONFIG.cloudName}/upload`, { method: "POST", body: fd });
      const data = await res.json();

      if(data.secure_url){
        const type = (data.resource_type === 'video' || (data.format && ['mp4','webm'].includes(data.format))) ? 'video' : 'image';
        const { error } = await supabaseClient.from('gallery').insert([{
            url: data.secure_url,
            type: type,
            title: els.mediaTitleInput.value || (type === 'video' ? 'Clip VIP' : 'Foto VIP'),
            public_id: data.public_id
        }]);
        if(!error) { alert("¬°Publicado! ‚òÅÔ∏è"); await loadData(); }
      }
    } catch(err) { console.error(err); alert("Error."); } 
    finally {
      btn.textContent = "Publicar"; btn.disabled = false;
      els.uploadModal.style.display = 'none'; state.pendingFile = null; els.fileInput.value = "";
    }
  });

  // --- UI HELPERS ---
  function updateStats(){
    const imgs = state.items.filter(i => i.type !== 'video').length;
    const vids = state.items.filter(i => i.type === 'video').length;
    els.stats.textContent = `${imgs} Capturas ¬∑ ${vids} Clips`;
  }
  
  window.viewItem = function(url, type){
    const overlay = document.createElement('div');
    overlay.style = "position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:9999;display:flex;align-items:center;justify-content:center;padding:20px;";
    const content = type === 'video' ? `<video src="${url}" controls autoplay style="max-width:100%;max-height:90vh;border-radius:8px;"></video>` : `<img src="${url}" style="max-width:100%;max-height:90vh;border-radius:8px;">`;
    overlay.innerHTML = `<div style="position:relative; width:100%; height:100%; display:flex; align-items:center; justify-content:center;">${content}<button id="closeLightbox" style="position:absolute; top:20px; right:20px; background:none; border:0; color:white; font-size:30px; cursor:pointer;">&times;</button></div>`;
    document.body.appendChild(overlay);
    overlay.querySelector('#closeLightbox').onclick = () => overlay.remove();
  };

  window.editMemberBadges = function(name) { 
    els.memberUsernameInput.value = name; 
    displayCurrentBadges(name); 
  };

  function populateBadgeSelect() {
    const select = els.memberBadgeSelect;
    select.innerHTML = '<option value="">(Seleccionar Insignia)</option>';
    Object.keys(BADGE_DATA).forEach(key => {
      const data = BADGE_DATA[key];
      const option = document.createElement('option');
      option.value = key; 
      option.textContent = `${data.icon} ${data.name}`;
      select.appendChild(option);
    });
  }

  // --- EVENTOS ---
  els.manageLogoBtn.onclick = () => { els.newLogoUrlInput.value = state.logoUrl; els.logoModal.style.display = 'flex'; };
  document.getElementById('closeLogoBtn').onclick = () => els.logoModal.style.display = 'none';
  
  els.manageBadgesBtn.onclick = () => { populateBadgeSelect(); renderRankedMemberList(); els.badgesModal.style.display = 'flex'; };
  document.getElementById('closeBadgesBtn').onclick = () => els.badgesModal.style.display = 'none';
  
  els.memberUsernameInput.oninput = () => displayCurrentBadges(els.memberUsernameInput.value.trim());
  els.memberBadgeSelect.onchange = () => displayCurrentBadges(els.memberUsernameInput.value.trim());
  
  document.getElementById('adminToggle').onclick = () => { els.loginModal.style.display = 'flex'; els.adminPassInput.focus(); };
  document.getElementById('closeLoginBtn').onclick = () => els.loginModal.style.display = 'none';
  
  document.getElementById('doLoginBtn').onclick = () => {
    if(els.adminPassInput.value === CONFIG.adminPass){
      state.isAdmin = true; els.adminControls.classList.remove('hidden'); els.loginModal.style.display = 'none'; renderGallery(); alert("‚úÖ Admin activo.");
    } else alert("‚ùå Acceso denegado.");
    els.adminPassInput.value = "";
  };

  document.getElementById('uploadTriggerBtn').onclick = () => els.fileInput.click();
  document.getElementById('cancelUploadBtn').onclick = () => { els.uploadModal.style.display = 'none'; state.pendingFile = null; els.fileInput.value = ""; };
  els.fileInput.onchange = (e) => { if(e.target.files[0]){ state.pendingFile = e.target.files[0]; els.mediaTitleInput.value = ""; els.uploadModal.style.display = 'flex'; } };
  els.mobileMenuBtn.onclick = () => els.mainNav.classList.toggle('open');

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => { if(entry.isIntersecting) entry.target.classList.add('visible'); });
  }, { threshold: 0.1 });
  document.querySelectorAll('.fade-in').forEach(el => observer.observe(el));
  
  loadData();
});  
</script>
</body>
</html>